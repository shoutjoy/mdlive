<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#1a1a24">
  <meta name="description" content="연구·논문 전용 마크다운 에디터 — 박중희">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="MD PRO V20">
  <link rel="manifest" id="pwa-manifest">
  <title>Markdown PDF Editor Pro</title>
  <link
    href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Figtree:wght@300;400;500;600;700&display=swap"
    rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div id="app">

    <!-- TITLEBAR -->
    <header id="titlebar">
      <div id="app-logo">
        <div class="logo-icon">M</div>MD PRO V20
      </div>
      <input id="doc-title" type="text" value="Untitled Document" spellcheck="false">
      <div id="tba">
        <span id="rm-badge">RESEARCH</span>
        <button class="btn btn-sm btn-tmpl" onclick="App.showTmpl()" data-tooltip="논문 양식 선택">📋 양식</button>
        <button class="btn btn-sm btn-research" onclick="App.toggleRM()" data-tooltip="Research Mode (단락 줄번호)"
          data-key="Ctrl+Shift+R">🔬 Research</button>
        <button class="btn btn-sm btn-ref" onclick="App.showCite()" data-tooltip="참고문헌 관리 & 인용"
          data-key="Ctrl+Shift+C">📚 References</button>
        <button class="btn btn-sm btn-scholar" onclick="Scholar.show()" data-tooltip="Google Scholar 검색 (새 창)"
          data-key="Ctrl+Shift+G">🔎 Scholar</button>
        <button class="btn btn-sm btn-save" onclick="App.showSaveDlg()" data-tooltip="저장 형식 선택" data-key="Ctrl+S">💾
          저장</button>
        <button class="btn btn-sm btn-print" onclick="App.printDoc()" data-tooltip="인쇄 / PDF 저장">🖨️ 인쇄</button>
      </div>
    </header>

    <!-- TOOLBAR -->
    <div id="toolbar">
      <!-- ☰ 사이드바 토글 -->
      <div class="tg"><button class="tb" onclick="App.toggleSidebar()" data-tooltip="사이드바">☰</button></div>
      <div class="ts"></div>

      <!-- 🟡 헤딩 — 노란색 계열 -->
      <div class="tg">
        <button class="tb tb-heading" onclick="ED.h(1)" data-tooltip="제목 H1" data-key="Ctrl+Alt+1"><b>H1</b></button>
        <button class="tb tb-heading" onclick="ED.h(2)" data-tooltip="제목 H2" data-key="Ctrl+Alt+2"><b>H2</b></button>
        <button class="tb tb-heading" onclick="ED.h(3)" data-tooltip="제목 H3" data-key="Ctrl+Alt+3"><b>H3</b></button>
      </div>
      <div class="ts"></div>

      <!-- 🟠 텍스트 서식 — 오렌지 계열 -->
      <div class="tg">
        <button class="tb tb-fmt" id="bold-btn" onclick="ED.bold()" data-tooltip="Smart Bold"
          data-key="Ctrl+B"><b>B</b></button>
        <button class="tb tb-fmt" id="italic-btn" onclick="ED.italic()" data-tooltip="기울임꼴"
          data-key="Ctrl+I"><i>I</i></button>
        <button class="tb tb-fmt" onclick="ED.strike()" data-tooltip="취소선">S̶</button>
        <button class="tb tb-fmt" onclick="ED.inlineCode()" data-tooltip="인라인 코드"><code
            style="font-size:10px">`c`</code></button>
      </div>
      <div class="ts"></div>

      <!-- 🟠 글자 크기 — 오렌지 계열 -->
      <div class="tg" style="gap:0">
        <button class="tb tb-fmt" onclick="FS.dec()" data-tooltip="선택 글자 크기 줄이기 (Shift+Alt+,)"
          style="min-width:22px;font-size:14px;font-weight:700;padding:0 4px">−</button>
        <div id="fsize-display"
          style="min-width:38px;text-align:center;font-family:var(--fm);font-size:12px;font-weight:600;color:#f7a06a;line-height:26px;cursor:pointer;user-select:none;background:#2a2a3a;border-top:1px solid #3a3a50;border-bottom:1px solid #3a3a50"
          data-tooltip="한번 클릭: 목록 / 두번 클릭: 직접 입력" onclick="FS.clickPick(event)" ondblclick="FS.startEdit(event)">12pt
        </div>
        <input id="fsize-input" type="text" value="12" onblur="FS.endEdit()" onkeydown="FS.editKey(event)"
          style="display:none;width:46px;text-align:center;font-family:var(--fm);font-size:12px;font-weight:600;color:#f7a06a;background:#2a2a3a;border:1px solid var(--ac);border-radius:3px;outline:none;padding:0 4px;height:22px;line-height:22px">
        <button class="tb tb-fmt" onclick="FS.inc()" data-tooltip="선택 글자 크기 키우기 (Shift+Alt+.)"
          style="min-width:22px;font-size:14px;font-weight:700;padding:0 4px">+</button>
      </div>

      <!-- 🟠 색상 — 오렌지 계열 -->
      <div class="tg">
        <button class="tb tb-fmt" id="fc-btn" onclick="App.openColorPicker('text')" data-tooltip="글자 색상"
          style="flex-direction:column;gap:1px">
          <span style="font-size:11px;font-weight:700">A</span>
          <span id="fc-bar" style="width:14px;height:2px;border-radius:1px;background:#e8e8f0"></span>
        </button>
        <button class="tb tb-fmt" id="hl-btn" onclick="App.openColorPicker('bg')" data-tooltip="형광펜 하이라이트"
          style="flex-direction:column;gap:1px">
          <span style="font-size:11px">🖊</span>
          <span id="hl-bar"
            style="width:14px;height:2px;border-radius:1px;background:transparent;border:1px solid var(--bd)"></span>
        </button>
      </div>
      <div class="ts"></div>

      <!-- 🟢 정렬 — 형광 초록 계열 -->
      <div class="tg">
        <button class="tb tb-layout" onclick="ED.align('left')" data-tooltip="왼쪽 정렬" data-key="Shift+Alt+L">⇤</button>
        <button class="tb tb-layout" onclick="ED.align('center')" data-tooltip="가운데 정렬"
          data-key="Shift+Alt+C">⇔</button>
        <button class="tb tb-layout" onclick="ED.align('right')" data-tooltip="오른쪽 정렬" data-key="Shift+Alt+R">⇥</button>
      </div>
      <div class="ts"></div>

      <!-- 🟢 목록·인용 — 형광 초록 계열 -->
      <div class="tg">
        <button class="tb tb-layout" onclick="ED.list('ul')" data-tooltip="목록">• List</button>
        <button class="tb tb-layout" onclick="ED.list('ol')" data-tooltip="번호 목록">1. List</button>
        <button class="tb tb-layout" onclick="ED.bquote()" data-tooltip="인용구" data-key="Ctrl+.">❝</button>
      </div>
      <div class="ts"></div>

      <!-- 🔵 표 — 파란/보라 계열 -->
      <div class="tg">
        <button class="tb tb-table" onclick="ED.table()" data-tooltip="표 삽입" data-key="Alt+8">⊞ 표</button>
        <button class="tb tb-table" onclick="ED.tableRow()" data-tooltip="행 추가" data-key="Alt+9">+행</button>
        <button class="tb tb-table" onclick="ED.tableCol()" data-tooltip="열 추가" data-key="Alt+0">+열</button>
        <button class="tb tb-table" onclick="ED.mergeH()" data-tooltip="가로 병합 (colspan)"
          data-key="Alt+Shift+H">⊞H</button>
        <button class="tb tb-table" onclick="ED.mergeV()" data-tooltip="세로 병합 (rowspan)"
          data-key="Alt+Shift+V">⊞V</button>
        <button class="tb tb-table-tidy" onclick="ED.tidyTable()" data-tooltip="HTML 표 들여쓰기 정돈 (커서를 표 안에 놓고 실행)">✦
          Tidy</button>
        <button class="tb tb-table" onclick="App.showCaption('table')" data-tooltip="표 캡션">〈표〉</button>
        <button class="tb tb-table" onclick="App.showCaption('fig')" data-tooltip="그림 캡션">[그림]</button>
      </div>
      <div class="ts"></div>

      <!-- 🔵 코드 — 파란/보라 계열 -->
      <div class="tg">
        <button class="tb tb-code" onclick="App.showCode()" data-tooltip="코드 블록 언어 선택 (메뉴) / Alt+C = 마지막 언어 직접 삽입">⌨
          Code</button>
      </div>
      <div class="ts"></div>

      <!-- 🔴 삽입/특수 — 분홍/연보라 계열 -->
      <div class="tg">
        <button class="tb tb-insert" onclick="ED.pageBreak()" data-tooltip="페이지 나누기" data-key="Ctrl+Enter">⋯ PB</button>
        <button class="tb tb-insert" onclick="ED.lineBreak()" data-tooltip="줄바꿈 &lt;br&gt;"
          data-key="Ctrl+Shift+Enter">↩</button>
        <button class="tb tb-insert" onclick="ED.insertNbsp()" data-tooltip="불연속 공백 &amp;nbsp; 삽입"
          data-key="Ctrl+Shift+Space">⎵</button>
        <button class="tb tb-insert" onclick="App.showImg()" data-tooltip="이미지">🖼</button>
        <button class="tb tb-insert" onclick="App.showLink()" data-tooltip="링크 (새 탭)">🔗</button>
        <button class="tb tb-insert" onclick="ED.footnote()" data-tooltip="각주">†</button>
        <button class="tb tb-insert" onclick="ED.math()" data-tooltip="수식(LaTeX)">∑</button>
        <button class="tb tb-insert" onclick="App.showCite()" data-tooltip="인용 삽입" data-key="Ctrl+Shift+C">📖</button>
        <button class="tb tb-insert" onclick="STATS.show()" data-tooltip="APA 통계 삽입"
          data-key="Shift+Alt+9">𝑓(x)</button>
      </div>
      <div class="ts"></div>

      <!-- 🔍 찾기 -->
      <div class="tg"><button class="tb tb-util" onclick="App.toggleFind()" data-tooltip="찾기/바꾸기"
          data-key="Ctrl+F">🔍</button></div>
      <div class="spacer"></div>

      <!-- ⚙ 보기 모드 -->
      <div class="tg">
        <button class="tb tb-view" onclick="App.setViewCycle('split')" id="vm-split" data-tooltip="분할 보기 (Alt+1)"
          data-key="Alt+1">Split</button>
        <button class="tb tb-view" onclick="App.setViewCycle('editor')" id="vm-editor" data-tooltip="에디터만 (Alt+2)"
          data-key="Alt+2">Edit</button>
        <button class="tb tb-view" onclick="App.setViewCycle('preview')" id="vm-preview" data-tooltip="미리보기만 (Alt+3)"
          data-key="Alt+3">View</button>
      </div>
      <div class="ts"></div>
      <div class="tg">
        <button class="tb tb-pv" id="pw-btn" onclick="PW.open()" data-tooltip="새창 미리보기" data-key="Ctrl+Shift+P">🗗
          PV</button>
        <button class="tb tb-pv" onclick="PW.openPPT()" data-tooltip="PPT 모드로 바로 열기" data-key="Ctrl+Shift+T">🎬
          PPT</button>
        <button class="tb tb-pv" onclick="PW.forceRefresh()" data-tooltip="새창 강제 새로고침">↻</button>
      </div>
      <div class="ts"></div>
      <div class="tg">
        <button class="tb tb-sys" onclick="App.toggleTheme()" data-tooltip="테마 전환">◑</button>
        <button class="tb tb-sys" id="ln-btn" onclick="LN.toggle()" data-tooltip="줄 번호">ln</button>
        <button class="tb tb-sys" onclick="App.showHK()" data-tooltip="단축키 목록" data-key="Alt+?">?</button>
      </div>
    </div>

    <!-- SIDEBAR -->
    <nav id="sidebar">
      <div id="sb-hdr">
        <span>목차 (TOC)</span>
        <div style="display:flex;gap:4px;align-items:center">
          <button class="btn btn-g btn-sm" style="font-size:10px;padding:1px 7px" onclick="TOC.insertTOC()"
            data-tooltip="문서 맨 앞에 목차 자동 삽입">📑 삽입</button>
          <button class="btn-ic" onclick="TOC.build(document.getElementById('editor').value)"
            data-tooltip="목차 새로고침">↻</button>
        </div>
      </div>
      <div id="toc-list">
        <div style="padding:12px;color:var(--tx3);font-size:12px">헤딩(#) 추가 시 자동 생성</div>
      </div>
      <div id="sb-stats"><span id="sw">0 단어</span><span id="sc">0 자</span><span id="sp">약 0 페이지</span></div>
    </nav>

    <!-- MAIN -->
    <main id="main">
      <div id="find-bar">
        <span style="font-size:11px;color:var(--tx3)">찾기</span>
        <input id="fi" type="text" placeholder="검색어..." onkeydown="App.findKey(event)">
        <span style="font-size:11px;color:var(--tx3)">바꾸기</span>
        <input id="ri" type="text" placeholder="바꿀 내용...">
        <button class="btn btn-g btn-sm" onclick="App.findNext()">다음</button>
        <button class="btn btn-g btn-sm" onclick="App.replaceOne()">바꾸기</button>
        <button class="btn btn-g btn-sm" onclick="App.replaceAll()">모두</button>
        <button class="btn-ic" onclick="App.toggleFind()">✕</button>
        <span id="fc-cnt" style="font-size:11px;color:var(--tx3)"></span>
      </div>
      <div id="editor-wrap">
        <div id="editor-pane">
          <div id="ed-hdr"><span class="pane-lbl"><span></span>MARKDOWN</span></div>
          <div id="ed-container">
            <div id="line-numbers">
              <div class="lnc" id="lnc"></div>
            </div>
            <textarea id="editor" placeholder="# 제목을 입력하세요&#10;&#10;여기에 Markdown을 작성하세요.&#10;Alt+? → 단축키 목록"
              spellcheck="false"></textarea>
          </div>
        </div>
        <div id="preview-pane">
          <div id="pv-hdr">
            <span class="pane-lbl"><span style="background:var(--ac2)"></span>PV</span>
            <span id="pg-cnt" style="font-size:9px;color:var(--ac);font-family:var(--fm);margin-left:4px"></span>
            <span id="render-ts" style="font-size:9px;color:var(--tx3);font-family:var(--fm);margin-left:4px"></span>
            <span class="spacer"></span>
            <div style="display:flex;align-items:center;gap:3px">
              <!-- 확대/축소 -->
              <button class="tb tb-sys" onclick="PV.zoomOut()" data-tooltip="미리보기 축소"
                style="font-size:14px;font-weight:700">－</button>
              <span id="pv-zoom-lbl"
                style="font-size:10px;font-family:var(--fm);color:#6acff7;min-width:32px;text-align:center">100%</span>
              <button class="tb tb-sys" onclick="PV.zoomIn()" data-tooltip="미리보기 확대"
                style="font-size:14px;font-weight:700">＋</button>
              <div class="ts"></div>
              <!-- PPT 모드 -->
              <button class="tb" id="ppt-btn" onclick="PV.togglePPT()"
                data-tooltip="PPT 모드 — 패널 너비에 맞춰 확대 후 페이지 단위 이동 (↑↓ 키)"
                style="font-size:10px;padding:0 7px;height:22px;color:#f0c060;border:1px solid rgba(240,192,96,.35);border-radius:4px;font-weight:600">🎬
                PPT</button>
              <div class="ts"></div>
              <!-- 폰트 크기 -->
              <div class="ts"></div>
              <span style="font-size:9px;color:rgba(255,255,255,.4);font-family:var(--fm)">폰트</span>
              <button class="tb tb-sys" onclick="PV.fontDown()" data-tooltip="폰트 축소" style="font-size:11px">ᴬ－</button>
              <span id="pv-font-lbl"
                style="font-size:10px;font-family:var(--fm);color:#6acff7;min-width:28px;text-align:center">11pt</span>
              <button class="tb tb-sys" onclick="PV.fontUp()" data-tooltip="폰트 확대" style="font-size:11px">ᴬ＋</button>
              <div class="ts"></div>
              <!-- Dark 테마 -->
              <button class="tb" id="pv-dark-btn" onclick="PV.toggleDark()" data-tooltip="미리보기 다크 테마 토글"
                style="font-size:10px;padding:0 7px;height:22px;color:#7ab8ff;border:1px solid rgba(100,160,255,.3);border-radius:4px;font-weight:600">◑
                Dark</button>
              <div class="ts"></div>
              <button class="tb tb-a4" id="a4-ruler-btn" onclick="A4Ruler.toggle()"
                data-tooltip="A4 페이지 구분선 표시/숨기기 — 297mm 위치에 빨간 점선">📄 A4</button>
              <button class="tb tb-copy-rich" id="copy-rich-btn" onclick="CP.copyRich()"
                data-tooltip="서식 있는 복사 — Word·구글독스에 붙여넣기 시 서식 유지">📋 복사</button>
              <button class="tb tb-copy-text" id="copy-text-btn" onclick="CP.copyText()"
                data-tooltip="텍스트 복사 — 서식 없이 순수 텍스트만">Ａ 텍스트</button>
            </div>
          </div>
          <div id="preview-container">
          </div>
          <div id="a4-overlay"></div>
          <!-- PPT 네비게이션 -->
          <div id="ppt-nav">
            <button onclick="PV.pptPrev()" title="이전 페이지 [←]">◀</button>
            <span id="ppt-pg">1 / 1</span>
            <button onclick="PV.pptNext()" title="다음 페이지 [→]">▶</button>
            <div style="width:1px;height:16px;background:rgba(255,255,255,.2);margin:0 4px"></div>
            <button onclick="PV.togglePPT()" title="PPT 모드 종료 [Esc]"
              style="font-size:13px;opacity:.6;background:none;border:none;cursor:pointer;color:#ddd;padding:0 4px">✕</button>
          </div>
        </div>
      </div>
      <div id="error-panel">
        <div id="ep-hdr"><span>⚠ 오류</span><button class="btn-ic" onclick="App.closeErr()">✕</button></div>
        <div id="ep-list"></div>
      </div>
    </main>

    <!-- STATUSBAR -->
    <div id="statusbar">
      <div class="si" id="autosave-indicator">
        <div class="save-dot" id="save-dot"></div><span id="save-st">저장됨</span>
      </div>
      <div class="ss">|</div>
      <div class="si" id="cursor-pos">줄 1, 열 1</div>
      <div class="ss">|</div>
      <div class="si" id="sel-info"></div>
      <div class="ssp"></div>
      <div class="si" id="error-count" onclick="App.toggleErr()"></div>
      <div class="ss" id="ec-sep" style="display:none">|</div>
      <div class="si">UTF-8</div>
      <div class="ss">|</div>
      <div class="si" id="mode-ind">NORMAL</div>
    </div>
  </div><!-- #app -->

  <!-- ═══════════════ MODALS ═══════════════ -->

  <!-- HOTKEY OVERLAY -->
  <div id="hk-overlay" onclick="App.hideHK()">
    <div id="hk-panel" onclick="event.stopPropagation()">
      <h2>
        <span>⌨ 단축키 목록</span>
        <div style="display:flex;align-items:center;gap:6px">
          <button class="btn btn-g btn-sm" id="hk-edit-btn" onclick="HK.toggleEdit()" style="font-size:11px">✎
            편집</button>
          <button class="btn-ic" onclick="App.hideHK()">✕</button>
        </div>
      </h2>

      <!-- 편집 모드 안내 -->
      <div id="hk-edit-hint"
        style="display:none;background:rgba(124,106,247,.1);border:1px solid var(--ac);border-radius:6px;padding:8px 12px;margin-bottom:12px;font-size:11px;color:var(--tx2);line-height:1.6">
        <b style="color:var(--ac)">편집 모드</b> — 설명 클릭 후 수정 | 단축키 클릭 후 수정 | <kbd
          style="background:var(--bg5);border:1px solid var(--bd);border-radius:3px;padding:1px 5px;font-size:10px">Del</kbd>
        행 삭제 | <button onclick="HK.addRow()" class="btn btn-g btn-sm"
          style="font-size:10px;padding:2px 7px;vertical-align:middle">+ 행 추가</button>
      </div>

      <!-- 단축키 목록 렌더 영역 -->
      <div id="hk-list-wrap"></div>

      <div style="margin-top:10px;font-size:11px;color:var(--tx3)" id="hk-footer-note">
        표 내부: Tab→다음 셀 | Enter→새 행 | ⌨ Code 버튼→언어 선택 | Alt+C→마지막 언어 직접 삽입
      </div>
      <div style="margin-top:8px;display:flex;gap:6px;justify-content:flex-end" id="hk-edit-actions"
        style="display:none">
        <button class="btn btn-g btn-sm" onclick="HK.resetDefault()">↩ 기본값 복원</button>
        <button class="btn btn-p btn-sm" onclick="HK.saveEdit()">저장</button>
      </div>
    </div>
  </div>

  <!-- SAVE DIALOG -->
  <div class="ov" id="save-modal">
    <div class="modal" style="max-width:400px">
      <h3>💾 저장 형식 선택</h3>
      <div style="display:flex;flex-direction:column;gap:9px;margin-bottom:16px">
        <button class="btn btn-g" style="justify-content:flex-start;padding:11px 14px;gap:10px" onclick="App.saveMD()">
          <span style="font-size:18px">📝</span>
          <div style="text-align:left">
            <div style="font-weight:600;font-size:13px">Markdown (.md)</div>
            <div style="font-size:11px;color:var(--tx2)">원본 마크다운 파일</div>
          </div>
        </button>
        <button class="btn btn-g" style="justify-content:flex-start;padding:11px 14px;gap:10px" onclick="App.saveTXT()">
          <span style="font-size:18px">📄</span>
          <div style="text-align:left">
            <div style="font-weight:600;font-size:13px">Plain Text (.txt)</div>
            <div style="font-size:11px;color:var(--tx2)">마크다운 기호 제거한 텍스트</div>
          </div>
        </button>
        <button class="btn btn-g" style="justify-content:flex-start;padding:11px 14px;gap:10px"
          onclick="App.saveHTML()">
          <span style="font-size:18px">🌐</span>
          <div style="text-align:left">
            <div style="font-weight:600;font-size:13px">HTML (.html)</div>
            <div style="font-size:11px;color:var(--tx2)">A4 다중 페이지 스타일 포함</div>
          </div>
        </button>
        <button class="btn btn-g" style="justify-content:flex-start;padding:11px 14px;gap:10px"
          onclick="App.printDoc()">
          <span style="font-size:18px">🖨️</span>
          <div style="text-align:left">
            <div style="font-weight:600;font-size:13px">인쇄 / PDF로 저장</div>
            <div style="font-size:11px;color:var(--tx2)">브라우저 인쇄창 → PDF 저장 가능 (전체 페이지)</div>
          </div>
        </button>
        <div
          style="display:flex;align-items:center;gap:10px;padding:10px 14px;background:var(--bg3);border-radius:var(--r);border:1px solid var(--bd)">
          <span style="font-size:16px">🔖</span>
          <div style="flex:1;text-align:left">
            <div style="font-weight:600;font-size:12px;color:var(--tx)">주석([^n]) 표시 설정</div>
            <div style="font-size:11px;color:var(--tx2);margin-top:2px">저장·인쇄 시 각주 표시 여부</div>
          </div>
          <label style="display:flex;align-items:center;gap:5px;cursor:pointer;font-size:12px;color:var(--tx2)">
            <input type="checkbox" id="show-footnotes-chk" checked style="accent-color:var(--ac)"> 표시
          </label>
        </div>
      </div>
      <div class="mf"><button class="btn btn-g btn-sm" onclick="App.hideModal('save-modal')">닫기</button></div>
    </div>
  </div>

  <!-- APA STATS MODAL -->
  <div class="ov" id="stats-modal">
    <div class="modal" style="max-width:560px">
      <h3>𝑓(x) APA 통계 결과 삽입 <span style="font-size:11px;color:var(--tx3);font-weight:400">Shift+Alt+9</span></h3>
      <!-- Analysis type selector -->
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:14px" id="stats-type-row">
        <button class="btn btn-tog btn-sm active" onclick="STATS.setType('ttest')" id="st-ttest">t-test</button>
        <button class="btn btn-tog btn-sm" onclick="STATS.setType('anova')" id="st-anova">ANOVA</button>
        <button class="btn btn-tog btn-sm" onclick="STATS.setType('regression')" id="st-regression">Regression</button>
        <button class="btn btn-tog btn-sm" onclick="STATS.setType('correlation')"
          id="st-correlation">Correlation</button>
        <button class="btn btn-tog btn-sm" onclick="STATS.setType('chisq')" id="st-chisq">Chi-square</button>
        <button class="btn btn-tog btn-sm" onclick="STATS.setType('sem')" id="st-sem">SEM</button>
        <button class="btn btn-tog btn-sm" onclick="STATS.setType('logistic')" id="st-logistic">Logistic</button>
        <button class="btn btn-tog btn-sm" onclick="STATS.setType('multilevel')" id="st-multilevel">Multilevel</button>
        <button class="btn btn-tog btn-sm" onclick="STATS.setType('custom')" id="st-custom"
          style="border-color:var(--ac2);color:var(--ac2)">✎ Custom</button>
      </div>
      <!-- Fields area -->
      <div id="stats-fields" style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:10px"></div>
      <!-- Custom area (hidden by default) -->
      <div id="stats-custom-area" style="display:none;margin-bottom:10px">
        <div class="fg"><label class="fl">커스텀 이름</label><input class="fi" id="custom-name" type="text"
            placeholder="예: Mixed ANOVA"></div>
        <div class="fg"><label class="fl">출력 포맷 <span style="color:var(--tx3);font-size:10px">{변수명} 사용</span></label>
          <input class="fi" id="custom-fmt" type="text" placeholder="예: (F({df1}, {df2}) = {F}, p = {p})">
        </div>
        <div class="fg" id="custom-vars-area"><label class="fl">변수 목록 <span style="color:var(--tx3);font-size:10px">콤마로
              구분</span></label>
          <input class="fi" id="custom-vars" type="text" placeholder="df1, df2, F, p"
            oninput="STATS.updateCustomVars()">
        </div>
        <div id="custom-fields" style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px"></div>
        <div style="margin-top:8px;display:flex;gap:6px;align-items:center">
          <button class="btn btn-g btn-sm" onclick="STATS.saveCustom()">💾 저장</button>
          <select id="custom-saved-sel" class="fi" style="width:auto;flex:1;padding:4px 8px;font-size:11px"
            onchange="STATS.loadCustom(this.value)">
            <option value="">— 저장된 커스텀 —</option>
          </select>
          <button class="btn btn-g btn-sm" style="color:var(--er)" onclick="STATS.deleteCustom()">삭제</button>
        </div>
      </div>
      <!-- Preview -->
      <div
        style="background:var(--bg3);border:1px solid var(--bd);border-radius:var(--r);padding:8px 12px;margin-bottom:12px;font-family:var(--fm);font-size:12px;color:var(--tx);min-height:28px">
        <span style="font-size:10px;color:var(--tx3);margin-right:6px">미리보기:</span><span id="stats-preview"
          style="color:var(--ac)"></span>
      </div>
      <div class="mf">
        <button class="btn btn-g btn-sm" onclick="App.hideModal('stats-modal')">취소</button>
        <button class="btn btn-p btn-sm" onclick="STATS.insert()">삽입</button>
      </div>
    </div>
  </div>

  <!-- CITATION MANAGER -->
  <div class="ov" id="cite-modal">
    <div class="modal xl">
      <h3>📚 참고문헌 관리 &amp; 인용 삽입</h3>
      <div class="tab-row">
        <div class="tab active" onclick="CM.tab('add')">① 참고문헌 추가</div>
        <div class="tab" onclick="CM.tab('cite')">② 인용 삽입</div>
        <div class="tab" onclick="CM.tab('convert')">③ 스타일 변환</div>
        <div class="tab" onclick="CM.tab('lib')">④ 저장된 목록</div>
        <div class="tab" onclick="CM.tab('search')" style="color:var(--ac2)">⑤ 🔎 논문 검색</div>
      </div>

      <!-- ADD -->
      <div class="tp active" id="cp-add">
        <div class="fg">
          <label class="fl">입력 구분 방식</label>
          <div style="display:flex;gap:8px;margin-bottom:10px">
            <button id="sep-blank-btn" class="btn btn-tog active btn-sm" style="flex:1" onclick="CM.setSep('blank')">
              📋 빈 줄로 구분<br><span style="font-size:10px;color:inherit;opacity:.8">항목 사이에 빈 줄 1개</span>
            </button>
            <button id="sep-line-btn" class="btn btn-tog btn-sm" style="flex:1" onclick="CM.setSep('line')">
              ↵ 엔터(줄바꿈)로 구분<br><span style="font-size:10px;color:inherit;opacity:.8">각 줄 = 1개 참고문헌</span>
            </button>
          </div>
        </div>
        <div class="fg">
          <label class="fl">APA 형식 참고문헌 붙여넣기</label>
          <textarea id="cite-raw" class="fi" style="min-height:130px" placeholder="여기에 참고문헌을 붙여넣으세요..."></textarea>
          <div style="display:flex;gap:8px;margin-top:7px;align-items:center;flex-wrap:wrap">
            <button class="btn btn-p btn-sm" onclick="CM.parse()">앱에서 사용하기 →</button>
            <button class="btn btn-g btn-sm" onclick="document.getElementById('cite-raw').value=''">지우기</button>
            <label class="btn btn-g btn-sm" style="cursor:pointer">📁 TXT 불러오기<input type="file" accept=".txt,.bib,.ris"
                style="display:none" onchange="CM.loadFile(event)"></label>
            <span id="cite-msg" style="font-size:11px;color:var(--ok)"></span>
          </div>
          <div style="margin-top:7px;font-size:11px;color:var(--tx3)" id="sep-desc">현재: 빈 줄로 구분 — 항목 사이에 빈 줄 하나를 넣어
            구분하세요.</div>
        </div>
      </div>

      <!-- CITE -->
      <div class="tp" id="cp-cite">
        <div style="display:flex;gap:7px;margin-bottom:9px;align-items:center">
          <input type="text" id="cite-search" class="fi" style="flex:1" placeholder="저자, 연도, 키워드로 검색..."
            oninput="CM.filter()">
          <button class="btn btn-g btn-sm" onclick="CM.selAll()">전체 선택</button>
          <button class="btn btn-g btn-sm" onclick="CM.clrSel()">선택 해제</button>
        </div>
        <div id="cite-list-area">
          <div class="cite-empty">추가 탭에서 먼저 참고문헌을 입력하세요.</div>
        </div>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-top:8px">
          <label style="font-size:12px;color:var(--tx2)">삽입 형식:</label>
          <select id="cite-style" class="fi" style="width:auto;padding:4px 8px">
            <option value="inline">인라인: (저자, 연도)</option>
            <option value="narrative">서술형: 저자(연도)</option>
            <option value="multi">복수: (A, 연도; B, 연도)</option>
            <option value="footnote">각주: [^n]</option>
          </select>
          <span id="cite-sc" style="font-size:11px;color:var(--tx3);margin-left:auto">0개 선택됨</span>
        </div>
      </div>

      <!-- CONVERT -->
      <div class="tp" id="cp-convert">
        <div style="display:flex;gap:8px;margin-bottom:12px;align-items:center;flex-wrap:wrap">
          <label style="font-size:12px;color:var(--tx2)">입력 스타일:</label>
          <select id="from-style" class="fi" style="width:auto;padding:4px 8px">
            <option value="apa" selected>APA 7 (기본)</option>
            <option value="mla">MLA 9</option>
            <option value="chicago">Chicago (Author-Date)</option>
            <option value="vancouver">Vancouver</option>
          </select>
          <span style="font-size:12px;color:var(--tx2)">→ 변환 대상:</span>
          <select id="to-style" class="fi" style="width:auto;padding:4px 8px">
            <option value="mla" selected>MLA 9</option>
            <option value="apa">APA 7</option>
            <option value="chicago">Chicago (Author-Date)</option>
            <option value="vancouver">Vancouver</option>
          </select>
          <button class="btn btn-p btn-sm" onclick="CM.convertStyle()">변환</button>
        </div>
        <div class="fg">
          <label class="fl">변환할 참고문헌 (저장 목록 미선택 시 직접 입력)</label>
          <textarea id="conv-input" class="fi" style="min-height:80px"
            placeholder="Kim, J. H., &amp; Lee, S. (2023). SEM in education. Journal of Educational Research, 45(2), 123–145."></textarea>
        </div>
        <div class="fg">
          <label class="fl">변환 결과 <span id="conv-label" style="color:var(--ac);font-weight:600"></span></label>
          <textarea id="conv-output" class="fi" style="min-height:80px" readonly
            placeholder="변환 결과가 여기 표시됩니다..."></textarea>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn btn-g btn-sm" onclick="CM.copyConverted()">📋 복사</button>
          <button class="btn btn-p btn-sm" onclick="CM.insertConverted()">에디터에 삽입</button>
        </div>
      </div>

      <!-- LIB -->
      <div class="tp" id="cp-lib">
        <div style="display:flex;gap:7px;margin-bottom:9px;align-items:center;flex-wrap:wrap">
          <span style="font-size:12px;color:var(--tx2)">저장 <span id="lib-cnt"
              style="color:var(--ac);font-weight:600">0</span>건</span>
          <span class="spacer"></span>
          <button class="btn btn-g btn-sm" onclick="CM.insertRefSection()">📄 참고문헌 섹션 삽입</button>
          <button class="btn btn-g btn-sm" onclick="CM.downloadLib()">⬇ 목록 다운로드</button>
          <button class="btn btn-g btn-sm" style="color:var(--er)" onclick="CM.clearAll()">전체 삭제</button>
        </div>
        <div id="lib-list">
          <div class="cite-empty">저장된 참고문헌이 없습니다.</div>
        </div>
      </div>

      <!-- SEARCH TAB -->
      <div class="tp" id="cp-search">
        <!-- 검색창 -->
        <div style="display:flex;gap:6px;margin-bottom:8px;align-items:flex-end;flex-wrap:wrap">
          <div style="flex:1;min-width:200px">
            <label class="fl">제목 / 저자 / 키워드</label>
            <input class="fi" id="ref-q" type="text" placeholder="예) self-efficacy academic achievement Korea"
              onkeydown="if(event.key==='Enter')RefSearch.search()">
          </div>
          <div style="flex:0 0 auto">
            <label class="fl">출판연도 이후</label>
            <select class="fi" id="ref-year" style="padding:7px 8px;width:auto">
              <option value="">전체</option>
              <option value="2020">2020~</option>
              <option value="2018">2018~</option>
              <option value="2015">2015~</option>
              <option value="2010">2010~</option>
            </select>
          </div>
          <div style="flex:0 0 auto">
            <label class="fl">검색 DB</label>
            <select class="fi" id="ref-db" style="padding:7px 8px;width:auto">
              <option value="crossref">CrossRef (전체)</option>
              <option value="openalex">OpenAlex (오픈액세스)</option>
            </select>
          </div>
          <button class="btn btn-p" onclick="RefSearch.search()" style="height:36px;padding:0 16px;flex-shrink:0">🔎
            검색</button>
          <button class="btn btn-g btn-sm" onclick="RefSearch.openScholar()" style="height:36px;flex-shrink:0"
            title="Google Scholar 새 창">Scholar ↗</button>
        </div>

        <!-- 상태/결과수 -->
        <div id="ref-status" style="font-size:11px;color:var(--tx3);min-height:18px;margin-bottom:6px"></div>

        <!-- 결과 목록 -->
        <div id="ref-results"
          style="border:1px solid var(--bd);border-radius:var(--r);background:var(--bg3);min-height:80px;max-height:340px;overflow-y:auto">
          <div class="cite-empty" id="ref-placeholder">검색어를 입력하고 🔎 검색을 누르세요.<br><span
              style="font-size:10px;color:var(--tx3)">CrossRef: 1억 건+ | OpenAlex: 오픈액세스 논문 특화</span></div>
        </div>

        <!-- 하단 안내 -->
        <div style="margin-top:8px;font-size:10px;color:var(--tx3);line-height:1.7">
          ✅ <b>+ 추가</b> 클릭 → APA 형식으로 ④ 저장된 목록에 자동 저장 &nbsp;|&nbsp;
          📋 <b>복사</b> 클릭 → 클립보드로 복사 &nbsp;|&nbsp;
          결과가 없으면 <b>Scholar ↗</b>로 직접 검색
        </div>
      </div>
      <button class="btn btn-g btn-sm" onclick="App.hideModal('cite-modal')">닫기</button>
      <button class="btn btn-p btn-sm" id="cite-ins-btn" onclick="CM.insert()" style="display:none">✔ 선택 항목 인용
        삽입</button>
    </div>
  </div>
  </div>

  <!-- CODE MODAL (toolbar button) -->
  <div class="ov" id="code-modal">
    <div class="modal" style="max-width:380px">
      <h3>코드 블록 언어 선택</h3>
      <div class="mb">
        <select class="fi" id="code-lang">
          <option value="">없음</option>
          <option value="python">Python</option>
          <option value="javascript">JavaScript</option>
          <option value="typescript">TypeScript</option>
          <option value="java">Java</option>
          <option value="c">C</option>
          <option value="cpp">C++</option>
          <option value="r">R</option>
          <option value="matlab">MATLAB</option>
          <option value="sql">SQL</option>
          <option value="bash">Bash/Shell</option>
          <option value="latex">LaTeX</option>
          <option value="html">HTML</option>
          <option value="css">CSS</option>
          <option value="json">JSON</option>
          <option value="yaml">YAML</option>
          <option value="markdown">Markdown</option>
        </select>
      </div>
      <div class="mf">
        <button class="btn btn-g btn-sm" onclick="App.hideModal('code-modal')">취소</button>
        <button class="btn btn-p btn-sm" onclick="ED.codeBlockModal()">삽입</button>
      </div>
    </div>
  </div>

  <!-- LINK MODAL -->
  <div class="ov" id="link-modal">
    <div class="modal" style="max-width:420px">
      <h3>🔗 링크 삽입 <span style="font-size:11px;color:var(--ac2)">(새 탭)</span></h3>
      <div class="mb">
        <div class="fg"><label class="fl">표시 텍스트</label><input class="fi" id="link-text" type="text"
            placeholder="링크 텍스트"></div>
        <div class="fg"><label class="fl">URL</label><input class="fi" id="link-url" type="text"
            placeholder="https://..."></div>
      </div>
      <div class="mf">
        <button class="btn btn-g btn-sm" onclick="App.hideModal('link-modal')">취소</button>
        <button class="btn btn-p btn-sm" onclick="ED.link()">삽입</button>
      </div>
    </div>
  </div>

  <!-- IMAGE MODAL -->
  <div class="ov" id="image-modal">
    <div class="modal" style="max-width:480px">
      <h3>🖼 이미지 삽입</h3>
      <!-- Drag & Drop Zone -->
      <div id="img-dropzone"
        style="border:2px dashed var(--bd);border-radius:8px;padding:20px;text-align:center;margin-bottom:14px;cursor:pointer;transition:all .2s;background:var(--bg3)"
        onclick="document.getElementById('img-file-input').click()" ondragover="IMG.dragOver(event)"
        ondragleave="IMG.dragLeave(event)" ondrop="IMG.drop(event)">
        <div id="img-drop-text" style="font-size:13px;color:var(--tx2)">🖼 이미지를 드래그하거나 클릭해서 선택</div>
        <div style="font-size:11px;color:var(--tx3);margin-top:4px">PNG, JPG, GIF, WebP 지원 · Base64로 자동 삽입</div>
        <input type="file" id="img-file-input" accept="image/*" style="display:none" onchange="IMG.fileSelected(event)">
      </div>
      <div id="img-preview-wrap" style="display:none;margin-bottom:12px;text-align:center">
        <img id="img-preview" style="max-width:100%;max-height:160px;border-radius:4px;border:1px solid var(--bd)">
      </div>
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px">
        <div style="flex:1;height:1px;background:var(--bd)"></div>
        <span style="font-size:11px;color:var(--tx3)">또는 URL 입력</span>
        <div style="flex:1;height:1px;background:var(--bd)"></div>
      </div>
      <div class="mb">
        <div class="fg"><label class="fl">Alt 텍스트</label><input class="fi" id="img-alt" type="text"
            placeholder="이미지 설명"></div>
        <div class="fg"><label class="fl">URL 또는 경로</label><input class="fi" id="img-url" type="text"
            placeholder="https://..."></div>
      </div>
      <div class="mf">
        <button class="btn btn-g btn-sm" onclick="App.hideModal('image-modal')">취소</button>
        <button class="btn btn-p btn-sm" onclick="ED.image()">삽입</button>
      </div>
    </div>
  </div>

  <!-- COLOR PICKER MODAL -->
  <!-- SCHOLAR SEARCH MODAL -->
  <div class="ov" id="scholar-modal">
    <div class="modal" style="max-width:520px">
      <h3>🔎 Google Scholar 검색</h3>
      <div class="fg">
        <label class="fl">검색어 (논문 제목, 저자, 키워드 등)</label>
        <div style="display:flex;gap:7px">
          <input class="fi" id="scholar-q" type="text" placeholder="예) structural equation modeling education Korea"
            style="flex:1" onkeydown="if(event.key==='Enter')Scholar.search()">
          <button class="btn btn-p" onclick="Scholar.search()" style="white-space:nowrap">검색 →</button>
        </div>
      </div>
      <div class="fg">
        <label class="fl">검색 옵션</label>
        <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
          <label style="font-size:12px;color:var(--tx2)">언어:</label>
          <select id="scholar-lang" class="fi" style="width:auto;padding:4px 8px">
            <option value="ko">한국어 우선</option>
            <option value="">전체</option>
            <option value="en">영어 우선</option>
          </select>
          <label style="font-size:12px;color:var(--tx2)">기간:</label>
          <select id="scholar-year" class="fi" style="width:auto;padding:4px 8px">
            <option value="">전체 기간</option>
            <option value="2024">2024년~</option>
            <option value="2022">2022년~</option>
            <option value="2020">2020년~</option>
            <option value="2015">2015년~</option>
            <option value="2010">2010년~</option>
          </select>
          <label style="display:flex;align-items:center;gap:4px;font-size:12px;color:var(--tx2);cursor:pointer">
            <input type="checkbox" id="scholar-review" style="accent-color:var(--ac)"> 리뷰 논문만
          </label>
        </div>
      </div>
      <div style="font-size:11px;color:var(--tx3);margin-bottom:10px;line-height:1.6">
        💡 검색 결과는 <b>Google Scholar 새 창</b>에서 열립니다.<br>
        논문 제목 클릭 → 인용 버튼 → APA 복사 → 📚 References 탭에 붙여넣기
      </div>
      <div class="fg" id="scholar-recent-wrap" style="display:none">
        <label class="fl">최근 검색어</label>
        <div id="scholar-recent" style="display:flex;gap:5px;flex-wrap:wrap"></div>
      </div>
      <div class="mf">
        <button class="btn btn-g btn-sm" onclick="Scholar.clear()">검색어 초기화</button>
        <button class="btn btn-g btn-sm" onclick="App.hideModal('scholar-modal')">닫기</button>
        <button class="btn btn-p btn-sm" onclick="Scholar.search()">🔎 Scholar 검색</button>
      </div>
    </div>
  </div>

  <div class="ov" id="color-modal">
    <div class="modal" style="max-width:400px">
      <h3 id="color-modal-title">글자 색상 설정</h3>
      <div class="fg">
        <label class="fl">빠른 선택</label>
        <div class="csw-row" id="color-swatches"></div>
      </div>
      <div class="fg">
        <div style="display:flex;gap:6px;align-items:center">
          <div style="flex:1">
            <label class="fl">직접 입력 (Hex 또는 색상명)</label>
            <input class="fi" id="color-hex" type="text" placeholder="#ff0000" style="font-family:var(--fm)"
              oninput="ColorPicker.updatePreview(this.value)">
          </div>
          <!-- 네이티브 color input (hidden) -->
          <div style="display:flex;flex-direction:column;align-items:center;gap:3px;flex-shrink:0;margin-top:14px">
            <label id="eyedrop-btn" class="btn btn-g btn-sm"
              style="cursor:pointer;padding:5px 8px;display:flex;flex-direction:column;align-items:center;gap:2px"
              title="스포이드 / 색상 팔레트">
              <span style="font-size:16px">🎨</span>
              <span style="font-size:9px">팔레트</span>
              <input type="color" id="color-native"
                style="position:absolute;opacity:0;width:0;height:0;pointer-events:none"
                oninput="ColorPicker.fromNative(this.value)" onchange="ColorPicker.fromNative(this.value)">
            </label>
            <button id="eyedropper-btn" class="btn btn-g btn-sm"
              style="padding:5px 8px;display:flex;flex-direction:column;align-items:center;gap:2px"
              onclick="ColorPicker.eyedrop()" title="화면에서 색상 추출 (스포이드)">
              <span style="font-size:16px">💉</span>
              <span style="font-size:9px">스포이드</span>
            </button>
          </div>
        </div>
      </div>
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
        <label class="fl" style="margin:0;flex-shrink:0">미리보기:</label>
        <div id="color-preview"
          style="flex:1;padding:5px 12px;border-radius:4px;font-size:13px;border:1px solid var(--bd);transition:all .15s">
          샘플 텍스트 / Sample Text</div>
      </div>
      <div id="eyedrop-support-msg" style="font-size:10px;color:var(--tx3);margin-bottom:8px;display:none">⚠ 스포이드는
        Chrome/Edge에서만 지원됩니다.</div>
      <div class="mf">
        <button class="btn btn-g btn-sm" onclick="App.hideModal('color-modal')">취소</button>
        <button class="btn btn-p btn-sm" onclick="App.applyColor()">적용</button>
      </div>
    </div>
  </div>

  <!-- CAPTION MODAL -->
  <div class="ov" id="caption-modal">
    <div class="modal" style="max-width:520px">
      <h3 id="cap-title">표 캡션 삽입</h3>
      <div class="fg">
        <label class="fl">형식 선택 (클릭으로 선택)</label>
        <div id="cap-opts" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px"></div>
      </div>
      <div style="display:flex;gap:10px;margin-bottom:10px">
        <div class="fg" style="flex:0 0 80px">
          <label class="fl">번호</label>
          <input class="fi" id="cap-num" type="text" placeholder="1" oninput="App.updateCapPreview()">
        </div>
        <div class="fg" style="flex:1">
          <label class="fl">설명 / 제목</label>
          <input class="fi" id="cap-desc" type="text" placeholder="내용을 입력하세요" oninput="App.updateCapPreview()">
        </div>
      </div>
      <div class="fg">
        <label class="fl">미리보기</label>
        <div id="cap-preview"
          style="background:var(--bg3);border:1px solid var(--bd);border-radius:var(--r);padding:8px 12px;font-family:var(--fm);font-size:12px;color:var(--tx);min-height:28px">
        </div>
      </div>
      <div class="mf">
        <button class="btn btn-g btn-sm" onclick="App.hideModal('caption-modal')">취소</button>
        <button class="btn btn-p btn-sm" onclick="App.insertCaption()">삽입</button>
      </div>
    </div>
  </div>

  <!-- TEMPLATE MODAL -->
  <div class="ov" id="tmpl-modal">
    <div class="modal lg">
      <h3>📋 논문 양식 선택</h3>
      <p style="font-size:12px;color:var(--tx2);margin-bottom:14px">선택하면 에디터에 구조가 자동 삽입됩니다. 기존 내용은 유지됩니다.</p>
      <div class="tmpl-grid" id="tmpl-grid"></div>
      <div class="mf"><button class="btn btn-g btn-sm" onclick="App.hideModal('tmpl-modal')">닫기</button></div>
    </div>
  </div>

  <!-- FORMAT QUICK PANEL (Alt+L) -->
  <div id="fmt-panel">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
      <h4 style="font-size:13px;font-weight:600;color:var(--txh);margin:0">✏️ 서식 설정 <span
          style="font-size:10px;color:var(--tx3);font-weight:400">Alt+L</span></h4>
      <button class="btn-ic" onclick="FP.hide()" style="font-size:14px">✕</button>
    </div>
    <!-- font size -->
    <div class="fmt-row">
      <span class="fmt-lbl">글자 크기</span>
      <button class="btn btn-g btn-sm" style="padding:2px 8px;font-size:13px;font-weight:700"
        onclick="FP.fsz(-1)">−</button>
      <select id="fp-fsize" class="fi" style="flex:1;padding:3px 6px;font-size:12px" onchange="FP.applyFsize()">
        <option>8pt</option>
        <option>9pt</option>
        <option>10pt</option>
        <option>11pt</option>
        <option selected>12pt</option>
        <option>13pt</option>
        <option>14pt</option>
        <option>15pt</option>
        <option>16pt</option>
        <option>18pt</option>
        <option>20pt</option>
        <option>22pt</option>
        <option>24pt</option>
        <option>28pt</option>
        <option>32pt</option>
        <option>36pt</option>
        <option>40pt</option>
        <option>48pt</option>
        <option>50pt</option>
      </select>
      <button class="btn btn-g btn-sm" style="padding:2px 8px;font-size:13px;font-weight:700"
        onclick="FP.fsz(1)">+</button>
    </div>
    <!-- font color -->
    <div class="fmt-row">
      <span class="fmt-lbl">글자 색</span>
      <div style="display:flex;gap:4px;flex-wrap:wrap;flex:1">
        <input type="color" id="fp-fc" value="#e8e8f0"
          style="width:30px;height:26px;border:none;border-radius:4px;cursor:pointer;background:none;padding:0"
          onchange="FP.applyColor()">
        <div style="display:flex;gap:3px;flex-wrap:wrap">
          <div class="csw" style="background:#e8e8f0" onclick="FP.setFc('#e8e8f0')" title="흰색계"></div>
          <div class="csw" style="background:#ff4444" onclick="FP.setFc('#ff4444')" title="빨강"></div>
          <div class="csw" style="background:#ff8800" onclick="FP.setFc('#ff8800')" title="주황"></div>
          <div class="csw" style="background:#ffcc00" onclick="FP.setFc('#ffcc00')" title="노랑"></div>
          <div class="csw" style="background:#44cc44" onclick="FP.setFc('#44cc44')" title="초록"></div>
          <div class="csw" style="background:#00aaff" onclick="FP.setFc('#00aaff')" title="파랑"></div>
          <div class="csw" style="background:#aa44ff" onclick="FP.setFc('#aa44ff')" title="보라"></div>
          <div class="csw" style="background:#ff44aa" onclick="FP.setFc('#ff44aa')" title="핑크"></div>
          <div class="csw" style="background:#333333" onclick="FP.setFc('#333333')" title="검정"></div>
          <div class="csw" style="background:#5b4ce4" onclick="FP.setFc('#5b4ce4')" title="인디고"></div>
        </div>
      </div>
    </div>
    <!-- highlight -->
    <div class="fmt-row">
      <span class="fmt-lbl">형광펜</span>
      <div style="display:flex;gap:4px;flex-wrap:wrap;flex:1">
        <input type="color" id="fp-hl" value="#fff176"
          style="width:30px;height:26px;border:none;border-radius:4px;cursor:pointer;background:none;padding:0"
          onchange="FP.applyHL()">
        <div style="display:flex;gap:3px;flex-wrap:wrap">
          <div class="csw" style="background:#fff176" onclick="FP.setHL('#fff176')" title="노랑"></div>
          <div class="csw" style="background:#ffcc80" onclick="FP.setHL('#ffcc80')" title="오렌지"></div>
          <div class="csw" style="background:#ef9a9a" onclick="FP.setHL('#ef9a9a')" title="빨강"></div>
          <div class="csw" style="background:#80cbc4" onclick="FP.setHL('#80cbc4')" title="민트"></div>
          <div class="csw" style="background:#a5d6a7" onclick="FP.setHL('#a5d6a7')" title="초록"></div>
          <div class="csw" style="background:#90caf9" onclick="FP.setHL('#90caf9')" title="파랑"></div>
          <div class="csw" style="background:#ce93d8" onclick="FP.setHL('#ce93d8')" title="보라"></div>
          <div class="csw" style="background:#f48fb1" onclick="FP.setHL('#f48fb1')" title="핑크"></div>
          <div class="csw" style="background:#ffecb3" onclick="FP.setHL('#ffecb3')" title="연노랑"></div>
          <div class="csw"
            style="background:repeating-linear-gradient(45deg,#888,#888 2px,transparent 2px,transparent 6px);border:1px solid #888"
            onclick="FP.setHL('none')" title="없음"></div>
        </div>
      </div>
    </div>
    <div style="text-align:right;margin-top:4px">
      <button class="btn btn-g btn-sm" onclick="FP.hide()">닫기</button>
    </div>
  </div>

  <div id="tooltip"></div>

  <script src="index.js"></script>
  
</body>

</html>.ippt-tool{background:none;border:1px solid
rgba(255,255,255,.15);border-radius:5px;color:#ccc;cursor:pointer;padding:1px 5px;transition:all .15s}
.ippt-tool:hover{background:rgba(255,255,255,.12);color:#fff}
.ippt-tool.active-tool{background:rgba(240,192,96,.25);color:#f7d06a;border-color:#f0c060}